..ROM 0
CALL start
RETURN

..ROM 1

.LABEL start
.COMMENT "inputs"
VALUE 3
VALUE 2
CALL ack
OUTPUT 1.0
RETURN

.LABEL ack
POP %0
KSETF
.USEFLAGS
POP %1
BRANCH !Z case2
PUSH %0
INC
RETURN

.LABEL case2
SETF %0
.USEFLAGS
BRANCH !Z case3
PUSH %1
DEC
VALUE 1
CALL ack
RETURN

.LABEL case3
PUSH %1
DEC
PUSH %1
PUSH %0
DEC
CALL ack
CALL ack
RETURN